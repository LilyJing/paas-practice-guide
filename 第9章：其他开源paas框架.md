# **第9章：其他开源PaaS框架**

在Cloudfoundry出现以后，特别是在Docker带动了容器的使用以后，在Kubernetes、Mesos+Marathon、Docker Swarm之外还出现了一些面向资源管理和编排的框架和平台。比较有代表性的有Rancher、Cloudify、Dies等，这些平台在开始基本都有自己的调度和编排能力，但是随着Kubernetes、Mesos+Marathon、Docker Swarm这些重量级平台的快速发展，其他的编排和调度平台也在慢慢改变自己的策略，比如继续发挥自己在编排和调度上的特性，来编排Kubernetes、Mesos+Marathon、Docker Swarm这些系统，毕竟这些系统和平台在使用起来还存在一定的门槛，比如Rancher除了可以自己管理Docker容器集群以外，同时还支持对Kubernetes、Mesos+Marathon和Docker Swarm的编排，也就是你可以在一个集群中同时使用三种编排工具，和Rancher类似的还有Cicso的Mantl平台也是支持同时运行Kubernetes、Mesos+Marathon，Rancher、Mantl以及StratOS还有几个共同点是他们都有一个非常非常漂亮的界面，让人第一眼就是上手试用的欲望，再着他们都很注意对上层应用的集成，形成了很多应用模板可以立马在集群中部署，第三他们都集成了在数据持久化、容器网络方面的解决办法，在通过他们来编排Kubernetes、Mesos或者Swarm的过程就把这些工作做好，让你可以最大程度的享受这些平台带来的好处。

上面说的Rancher、Mantl是发挥自身的优势来让我们可以更快的使用到Kubernetes、Mesos、Swarm工具，像Cloudify、Deis这样的编排工具则选择了另一种方式，就是把自己的API和Kubernetes的API进行了映射，这样对于原有的用户来说就可以很方便的已经运行起来的应用迁移到Kubernetes平台上来，同时也大大减低了学习曲线，保留了原有用户的使用习惯。Cloudify提出的blueprint概念就可以和Kubernetes的对象映射起来，Cloudify的拖拉式的操作看起确实很舒服。Deis除了把自己的Api和Kubernetes进行了映射以外，还对Kubernetes进行了扩充，比如增加了router、builder、logger、monitor等组件也为PAAS平台提供了更完整的能力。Apache的StratOS项目也可以和Kubernetes集群进行对接，但是StratOS项目本身局限在Tomcat、PHP、MYSQL类型的应用上，这在一定程度上限制了Kubernetes的作用。

除了编排、对接Kubernetes、Mesos、Swarm等框架外，我们还看到直接在这些框架基础上进行二次开发的产品，比如红帽的OpenShift、CoreOS的Tectonic，OpenShift在版本2以后全面转向Kubernetes，基于Kubernetes对容器的编排和调度能力构建了Openshift V3，除了加强了Kubernetes的安全、提供更友好的界面、提供单点登陆能力外，提供了持续集成/交付能力、內建镜像仓库等特性，我们可以在OpenShift中关联Git代码库来构建镜像，一方面可以将镜像存储在內建镜像仓库中，另一方面可以将镜像部署到OpenShift中借助Kubernetes的编排、调度能力来启动应用，同时我们可以在镜像的构建和部署环节上设置一些触发器，这样当代码变更（需配置WebHook）、镜像变更时就可以触发镜像的自动构建和部署，同时OpenShift还提供了一个Router组件来方便在集群外访问运行在容器中的应用，Router本身是一个基于Haproxy封装的程序，它可以跟踪Service和Pod的变化来维护Haproxy的配置，同时我们可以通过Router为每个Service定义一个DNS名，这样我们就可以在集群外通过DNS名来访问集权内的应用了，当然目前Kubernetes本身也提供了一个ingress对象其实和Kubernetes的Router的作用是类似的，但是Openshift的Router组件要比Ingress早很多。Openshift V3包括在线、企业、开源（Origin）三个版本，现在在CentOS的YUM源中增加了一个PAAS目录对应的就是Openshift的开源版本，我们也可以方便的在<github.com/openshift/origin>查找openshift的源代码，同时OpenShift提供了一套非常完整的ansible脚本来支持OpenShift的安装，可以完成Openshift各组件的安装、配置，还可以支持openvswitch的安装、配置。CoreOS的Tectonic还只有商业版本就不做过多表述了。

还有一些开源的PaaS平台，比如Flynn只是集成了Docker来增强对运行时的支持，一开始Flynn是参考CloudFoundry进行设计的，有Router来让应用可以从集群外访问，有buildpack来支持运行时，同时还提供了预装的MySql、PostgreSql、Redis、MongoDB来作为后端服务。现在Flynn可以很方便的从一个代码库中构建镜像然后部署到Flynn集群中。
